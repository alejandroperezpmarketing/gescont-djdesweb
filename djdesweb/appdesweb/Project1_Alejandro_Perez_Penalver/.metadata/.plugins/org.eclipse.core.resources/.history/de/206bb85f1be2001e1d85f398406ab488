'''
Created on 14 mar. 2024

@author: vagrant
'''

class Conn():
    conn=None
    cursor=None
    def __init__(self):
        self.conn=psycopg2.connect(database="test1",user="postgres",password="postgres", host="localhost", port = 5432)
        self.cursor=self.conn.cursor()
        
    def close(self):
        self.conn.close()


class Clientes():
    
    conn:Conn
    def __init__(self,conn:Conn):
        self.conn=conn

    def insert_client(self,the_name,the_surname)->int:
        
        q =f"insert into d.clients (the_name,the_surname) values (%s,%s) returning gid"
        self.conn.cursor.execute(q,[the_name,the_surname])
        #self.conn.cursor.execute(q,[d['client_type'],d['sex'],d['name'],d['last_name'],d['age'],d['purchase_date'],d['client_motivation'],d['channel_id'],d['geomWkt'])
        self.conn.conn.commit()
        gid = self.conn.cursor.fetchall()[0][0]
        return {'ok':True,'message':f'Cliente insertado. gid: {gid}','data':[[gid]]}
     
     
     
class Patients():
    
    conn:Conn
    def __init__(self,conn:Conn):
        self.conn=conn

    